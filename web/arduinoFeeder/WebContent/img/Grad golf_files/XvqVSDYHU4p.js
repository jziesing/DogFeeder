/*!CK:3798175809!*//*1401158265,178187597*/

if (self.CavalryLogger) { CavalryLogger.start_js(["NkO2\/"]); }

__d("BrowseCollapsedSidebar",["Event","Arbiter","Animation","BrowseMouse","BrowseControls","CSS","DOM","Ease","Style","Vector","copyProperties","cx","getUnboundedScrollPosition","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u=50,v=500,w=60,x=298,y=400,z=n.makePowerOut(3),aa="_9pq",ba="_9pr",ca="_cbu",da="_cbv";function ea(fa,ga,ha,ia,ja){this._anchor=fa;this._positioner=fa.firstChild;this._wrapper=this._positioner.firstChild;this._header=ga;this._content=ha;this._scrollableNode=ia;this._scrollableArea=ja;this._collapsedSize=null;this._currentSize=null;this._anchorPosition=null;this._animation=false;this._mouseInside=false;this._closeTimeout=null;this._initContainerSizes();this._initEvents();}q(ea.prototype,{_initContainerSizes:function(){this._collapsedSize=p.getElementDimensions(this._header);this._collapsedSize.x=Math.min(this._collapsedSize.x,x);o.set(this._wrapper,'width',this._collapsedSize.x+'px');o.set(this._wrapper,'height',this._collapsedSize.y+'px');o.set(this._anchor,'width',x+'px');o.set(this._positioner,'width',x+'px');o.set(this._content,'width',x+'px');this._anchorPosition=p.getElementPosition(this._anchor,'document');},_initEvents:function(){j.makeTarget(this._anchor);j.onMouseOver(this._anchor,this._mouseOver.bind(this));j.onMouseOut(this._anchor,this._mouseOut.bind(this));g.listen(this._anchor,'focusout',this._focusOut.bind(this,false));g.listen(window,'scroll',t(this._handleScroll,50,this));h.subscribe('BrowseSidebar/resize',this._handleResize.bind(this));},_handleScroll:function(){var fa=Math.max(0,s(window).y),ga=fa+w>this._anchorPosition.y;l.conditionClass(this._positioner,'fixed_elem',ga);o.set(this._positioner,'top',w+'px');},_calculateExpandedSize:function(fa){var ga=p.getViewportDimensions(),ha=p.getElementDimensions(this._content),ia=ga.y-this._anchorPosition.y-u,ja=this._collapsedSize.y+ha.y+(fa||0);return {x:x,y:Math.min(ja,ia)};},_resizeScrollable:function(fa){var ga=fa.y-this._collapsedSize.y;o.set(this._scrollableNode,'height',ga+'px');o.set(this._scrollableNode,'width',fa.x+'px');this._scrollableArea.poke();this._scrollableArea.resize();},_handleResize:function(fa,ga){var ha=this._calculateExpandedSize(ga&&ga.offsetHeight),ia=this._resizeScrollable.bind(this,ha);if(!this._currentSize||ha.y>this._currentSize.y)ia();this._animateSize(this._currentSize,ha,ia,ga);},_toggleCollapsed:function(fa){if(this._collapsed==fa)return;var ga=this._calculateExpandedSize();this._collapsed=fa;this._resizeScrollable(ga);this._animateSize(fa?ga:this._collapsedSize,fa?this._collapsedSize:ga);l.conditionClass(this._anchor,aa,fa);l.conditionClass(this._anchor,ba,!fa);if(fa)k.closeActive();},_animateSize:function(fa,ga,ha,ia){ia=ia||{};l.addClass(this._anchor,ca);l.removeClass(this._anchor,da);this._currentSize=ga;this._animation&&this._animation.stop();this._animation=new i(this._wrapper).from('width',fa.x).to('width',ga.x).from('height',fa.y).to('height',ga.y).duration(ia.duration||y).ease(ia.ease||z).ondone(function(){l.removeClass(this._anchor,ca);l.addClass(this._anchor,da);ha&&ha();}.bind(this)).ease(n.circOut).go();},_mouseOver:function(){window.clearTimeout(this._closeTimeout);this._toggleCollapsed(false);this._mouseInside=true;},_mouseOut:function(){this._mouseInside=false;this._closeTimeout=window.setTimeout(function(){var fa=document.activeElement,ga=fa&&fa.tagName=='INPUT'&&m.contains(this._anchor,fa);ga||this._toggleCollapsed(true);}.bind(this),v);},_focusOut:function(fa,ga){this._mouseInside||this._mouseOut();}});e.exports=ea;},null);
__d("BrowseControlsDateTypeaheadInput",["BrowseControlsTypeaheadInput"],function(a,b,c,d,e,f,g){for(var h in g)if(g.hasOwnProperty(h))j[h]=g[h];var i=g===null?null:g.prototype;j.prototype=Object.create(i);j.prototype.constructor=j;j.__superConstructor__=g;function j(){"use strict";if(g!==null)g.apply(this,arguments);}j.prototype.getURIForValue=function(k){"use strict";var l=this._uri.replace(this.getIDSentinel(),k);if(k.indexOf('/')!==-1){return l.replace(k+'/date/',k+'/date-2/');}else return l;};e.exports=j;},null);
__d("DateDataSource",["fbt","DataSource"],function(a,b,c,d,e,f,g,h){var i=['jan','feb','mar','apr','may','jun','jul','aug','sep','oct','nov','dec'],j=["January","February","March","April","May","June","July","August","September","October","November","December"];for(var k in h)if(h.hasOwnProperty(k))m[k]=h[k];var l=h===null?null:h.prototype;m.prototype=Object.create(l);m.prototype.constructor=m;m.__superConstructor__=h;function m(n){"use strict";h.call(this,n);this.minYear=n.minYear;this.currentYear=n.currentYear;this.currentMonth=n.currentMonth;}m.prototype.init=function(){"use strict";l.init.call(this);var n=[];for(var o=this.currentYear;o>=this.minYear;o--){n.push({uid:o,text:o+'',type:'text'});var p=i.length-1;if(o===this.currentYear)p=this.currentMonth-1;for(;p>=0;p--)n.push({uid:i[p]+'/'+o,text:j[p]+' '+o,type:'text'});}this.addEntries(n);};e.exports=m;},null);
__d("PlacesDataSource",["DataSource"],function(a,b,c,d,e,f,g){for(var h in g)if(g.hasOwnProperty(h))j[h]=g[h];var i=g===null?null:g.prototype;j.prototype=Object.create(i);j.prototype.constructor=j;j.__superConstructor__=g;function j(k){"use strict";g.call(this,k);this._origBootstrapEndpoint=this.bootstrapEndpoint;}j.prototype.shouldFetchMoreResults=function(k){"use strict";if(this.queryData.new_js_ranking){return true;}else return i.shouldFetchMoreResults.call(this,k);};j.prototype.mergeUids=function(k,l,m,n){"use strict";if(this.queryData.new_js_ranking){this._checkExtendedMatch(n,k);return this.deduplicateByKey(m.concat(l,k));}else return i.mergeUids.call(this,k,l,m,n);};j.prototype.resetBootstrapEndpoint=function(k){"use strict";this.setBootstrapEndpoint(this._origBootstrapEndpoint,k);return this;};j.prototype.setBootstrapEndpoint=function(k,l){"use strict";if(this.bootstrapEndpoint!==k){this.bootstrapEndpoint=k;if(this._bootstrapped||this._bootstrapping)l=true;}if(l)this.dirty().bootstrap();return this;};j.prototype.getQueryEndpoint=function(){"use strict";return this.queryEndpoint;};j.prototype.getBootstrapData=function(){"use strict";return this.bootstrapData;};e.exports=j;},null);
__d("PlacesTypeaheadCore",["Arbiter","CSS","Focus","Run","StickyPlaceholderInput","Style","TypeaheadCore","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){for(var o in m)if(m.hasOwnProperty(o))q[o]=m[o];var p=m===null?null:m.prototype;q.prototype=Object.create(p);q.prototype.constructor=q;q.__superConstructor__=m;function q(){"use strict";if(m!==null)m.apply(this,arguments);}q.prototype.init=function(r,s,t){"use strict";p.init.call(this,r,s,t);this.arbiterTokens=[g.subscribe('Places/PlaceCreationCancel'+this.callbackID,function(u,v){this.view.allowPlaceCreation=false;this.view.allowFreeformOption=true;this.view.reset();this.focusElement();}.bind(this))];j.onLeave(function(){this.arbiterTokens.forEach(g.unsubscribe);}.bind(this));this._typeaheadID=t.id;this._citySet=false;this.data.subscribe('fetchComplete',this.update.bind(this));};q.prototype.initToggle=function(){"use strict";var r=this.root.parentNode,s=l.get(r,'position')!='static'?r:this.root,t=this.view,u='PlacesTypeaheadFocused';this.subscribe('focus',function(){t.show();h.addClass(s,u);});this.subscribe('blur',function(){t.hide();h.removeClass(s,u);});};q.prototype.focusElement=function(){"use strict";i.set(this.element);this.value='';this.checkValue();};q.prototype.setValue=function(r){"use strict";p.setValue.call(this,r);k.update(this.element);};q.prototype.updateDataSource=function(r){"use strict";this.data.setQueryData({city_id:this._cityId,city_set:this._citySet});this.data.setBootstrapData({city_id:this._cityId});if(r){this.data.dirty();this.data.bootstrap();}};q.prototype.setCity=function(r,s){"use strict";this._citySet=s;if(this._cityId!==r){this._cityId=r;this.updateDataSource(s);}};q.prototype.update=function(r,s){"use strict";var t=s.response;if(!t)return;var u=t.getPayload();if(u.cityId)if(!this._citySet)this.setCity(u.cityId,false);};n(q.prototype,{resetOnKeyup:false});e.exports=q;},null);
__d("PlacesTypeaheadBehavior",["CSS","DOM"],function(a,b,c,d,e,f,g,h){var i={init:function(j,k){j.subscribe(['reset','select','highlight'],function(l,m){if(l==='highlight'&&m.index!==-1&&m.selected.type!='freeform'&&m.selected.map&&!m.selected.changeCity){h.setContent(k,m.selected.map);g.show(k);}else g.hide(k);});}};e.exports=i;},null);
__d("NoTrucatingCompactTypeaheadRenderer",["CompactTypeaheadRenderer"],function(a,b,c,d,e,f,g){function h(i,j){return g(i,j);}h.className='noTrucating compact';e.exports=h;},null);
__d("PlaceTypeaheadButton",["CSS"],function(a,b,c,d,e,f,g){var h={toggleButton:function(i,j){g.addClass(i,'uiButtonDisabled');j.getView().subscribe('select',g.removeClass.bind(null,i,'uiButtonDisabled'));j.getView().subscribe('select',g.removeClass.bind(null,i,'hidden_elem'));j.getCore().subscribe('unselect',g.addClass.bind(null,i,'uiButtonDisabled'));}};e.exports=h;},null);
__d("legacy:place-typeahead-toggle-button",["PlaceTypeaheadButton"],function(a,b,c,d){a.PlaceTypeaheadButton=b('PlaceTypeaheadButton');},3);
__d("PlacesTypeaheadView",["Arbiter","CSS","Dialog","DOM","Parent","Run","ScrollableArea","Style","TypeaheadView","copyProperties","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){for(var r in o)if(o.hasOwnProperty(r))t[r]=o[r];var s=o===null?null:o.prototype;t.prototype=Object.create(s);t.prototype.constructor=t;t.__superConstructor__=o;function t(){"use strict";if(o!==null)o.apply(this,arguments);}t.prototype.init=function(){"use strict";this.content=j.find(this.element,'div.PlacesTypeaheadViewList');s.init.call(this);this.subscribe(['render','reset'],this.renderBorders.bind(this));this.arbiterTokens=[g.subscribe('Places/PlaceCreated'+this.callbackID,function(u,v){var w={text:v.name,rawtext:v.name,uid:v.fbid,city_id:v.city_id,city_name:v.city_name,city_page_id:v.city_page_id};this.inform('select',{index:-1,clicked:true,selected:w});this.inform('afterSelect');}.bind(this))];this.arbiterTokens.push(g.subscribe('Events/autoSuggestionSelected',function(u,v){this.inform('select',{index:-1,clicked:true,selected:{text:v.event_name,rawtext:v.event_name,uid:v.event_fbid}});this.inform('afterSelect');}.bind(this)));l.onLeave(function(){this.arbiterTokens.forEach(g.unsubscribe);}.bind(this));};t.prototype.renderBorders=function(){"use strict";h.conditionClass(this.element,'PlacesTypeaheadViewPopulated',this.items.length);};t.prototype.show=function(){"use strict";s.show.call(this);if(!this.results||!this.results.length)n.set(this.element,'height',0);};t.prototype.render=function(u,v,w){"use strict";v.forEach(function(aa){aa.value=u;});if(this.allowFreeformOption&&u&&(!v||v.length===0||v[v.length-1].type!='freeform')){var x=q._("Just use \"{custom_location}\"",{custom_location:u});v.push({uid:'0',rawtext:u,text:x,type:'freeform'});}if(this.allowPlaceCreation&&u&&(!v||v.length===0||v[v.length-1].type!='placecreate')){var y=q._("Add place \"{custom_location}\"",{custom_location:u});v.push({uid:'0',rawtext:u,text:y,type:'placecreate'});}s.render.call(this,u,v,w);this.element.style.visibility='hidden';if(this.visible&&this.results&&this.results.length)n.set(this.element,'height','');var z=m.getInstance(this.content);z&&z.adjustGripper();this.inform('afterRender',v);this.element.style.visibility='';};t.prototype.select=function(u){"use strict";var v=this.index,w=this.results[v];if(w){if(w.type==='placecreate'){i.bootstrap('/ajax/places/create/dialog.php',{name:w.rawtext,callback_id:this.callbackID});return;}if(w.type==='freeform')w.text=w.rawtext;s.select.call(this,u);}};t.prototype.next=function(){"use strict";s.next.call(this);this._scrollIntoView(this.selected);};t.prototype.prev=function(){"use strict";s.prev.call(this);this._scrollIntoView(this.selected);};t.prototype._scrollIntoView=function(u){"use strict";if(!k.byClass(u,'uiScrollableArea'))return;this.ignoreNextMouseover=true;var v=k.byClass(u,'uiScrollableAreaWrap'),w=u.offsetTop-v.offsetTop;if(w<v.scrollTop){v.scrollTop=w;return;}var x=w+u.offsetHeight;if(x>v.scrollTop+v.offsetHeight)v.scrollTop=x-v.offsetHeight;};t.prototype.mouseover=function(event){"use strict";this.ignoreNextMouseover||s.mouseover.call(this,event);this.ignoreNextMouseover=false;};t.prototype.highlight=function(u){"use strict";s.highlight.call(this,u,true);};p(t.prototype,{ignoreNextMouseover:false});e.exports=t;},null);
__d("legacy:PreventSubmitOnEnterTypeaheadBehavior",["TypeaheadPreventSubmitOnEnter"],function(a,b,c,d,e,f,g){if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.preventSubmitOnEnter=function(h){h.enableBehavior(g);};},3);
__d("legacy:ShowResultsOnFocusTypeaheadBehavior",["TypeaheadShowResultsOnFocus"],function(a,b,c,d,e,f,g){if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.showResultsOnFocus=function(h){h.enableBehavior(g);};},3);